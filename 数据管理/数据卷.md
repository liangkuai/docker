# 数据卷

数据卷让你可以不受容器生命周期影响进行数据持久化。它们表现为容器内的空间，但实际保存在容器之外，从而允许你在不影响数据的情况下销毁、重建、修改、丢弃容器。

卷是针对容器的，你可以使用同一个镜像创建多个容器并定义不同的卷。卷保存在运行 Docker 的宿主机文件系统上，你可以指定卷存放的目录，或让 Docker 保存在默认位置。

**数据卷是一个可供一个或多个容器使用的特殊目录**，它绕过 UFS。有以下特性：

- 数据卷可以在容器之间共享和重用
- 对数据卷的修改会立马生效
- 对数据卷的更新，不会影响镜像
- 数据卷默认会一直存在，即使容器被删除


### 1. 创建

```bash
# 创建一个数据卷
$ docker volume create 数据卷名
```


### 2. 使用

数据卷的使用，类似于 Linux 下对目录或文件进行 mount，**容器中的被指定为挂载点的目录中原有的文件会隐藏掉**，能显示看的是挂载的数据卷。

```bash
# 方式一：-v
# 方式二：--mount

$ docker run ... \
    ... \
    ... \
    # -v 数据卷名:/wepapp \
    --mount source=数据卷名,target=/webapp \
    ... \
    ...
```


### 3. 删除

数据卷是被设计用来持久化数据的，它的生命周期独立于容器，**Docker 不会在容器被删除后自动删除数据卷**，并且也不存在垃圾回收这样的机制来处理没有任何容器引用的数据卷。如果需要在删除容器的同时移除数据卷，可以在删除容器的时候使用 `docker rm -v` 这个命令。

```bash
# 删除指定数据卷
$ docker volume rm 数据卷名

# 删除未被使用的数据卷
$ docker volume prune
```


### 4. 查看

```bash
# 查看所有数据卷
$ docker volume ls
```


### 5. 查看容器的数据卷详细信息

```bash
$ docker inspect 容器名

...
...
"Mounts": [
    {
        "Type": "volume",
        "Name": "my-vol",
        "Source": "/var/lib/docker/volumes/my-vol/_data",
        "Destination": "/app",
        "Driver": "local",
        "Mode": "",
        "RW": true,
        "Propagation": ""
    }
],
...
...
```
